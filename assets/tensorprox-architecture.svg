<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600">
  <!-- Background with subtle gradient -->
  <defs>
    <linearGradient id="bg-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f9f9f9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f0f0f0;stop-opacity:1" />
    </linearGradient>
    
    <!-- Arrow markers -->
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#2851a3"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#c0392b"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#27ae60"/>
    </marker>
    
    <!-- Shadow filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="3" />
      <feOffset dx="2" dy="2" result="offsetblur" />
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.2" />
      </feComponentTransfer>
      <feMerge>
        <feMergeNode />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    
    <!-- Node gradients -->
    <linearGradient id="tgenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6C8EBF;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4A6EA5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="moatGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#82B366;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#5D8A4A;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="kingGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#DAE8FC;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7EA6E0;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="600" fill="url(#bg-gradient)"/>
  
    <!-- Subtle grid pattern -->
  <path d="M0,50 L800,50 M0,100 L800,100 M0,150 L800,150 M0,200 L800,200 M0,250 L800,250 M0,300 L800,300 M0,350 L800,350 M0,400 L800,400 M0,450 L800,450" stroke="#e0e0e0" stroke-width="0.5"/>
  <path d="M50,0 L50,500 M100,0 L100,500 M150,0 L150,500 M200,0 L200,500 M250,0 L250,500 M300,0 L300,500 M350,0 L350,500 M400,0 L400,500 M450,0 L450,500 M500,0 L500,500 M550,0 L550,500 M600,0 L600,500 M650,0 L650,500 M700,0 L700,500 M750,0 L750,500" stroke="#e0e0e0" stroke-width="0.5"/>

  <!-- Title and Subtitle -->
  <text x="500" y="50" font-family="Arial, Helvetica, sans-serif" font-size="28" text-anchor="middle" font-weight="bold" fill="#333">Tensorprox: Scalable DDoS Protection Architecture</text>
  <text x="500" y="80" font-family="Arial, Helvetica, sans-serif" font-size="16" text-anchor="middle" fill="#666">Distributed Traffic Generation and Filtering System</text>

  <!-- Physical Network Border -->
  <rect x="100" y="100" width="800" height="450" fill="none" stroke="#888" stroke-width="2" stroke-dasharray="5,5" rx="15" ry="15"/>
  <text x="160" y="125" font-family="Arial, Helvetica, sans-serif" font-size="14" fill="#555">Physical Network (10.0.0.0/24)</text>
  
  <!-- Traffic Generators Section -->
  <rect x="130" y="160" width="300" height="350" rx="10" ry="10" fill="rgba(224, 231, 255, 0.2)" stroke="#2D5082" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="280" y="180" font-family="Arial, Helvetica, sans-serif" font-size="18" text-anchor="middle" font-weight="bold" fill="#2D5082">Scalable Traffic Generators</text>
  
  <!-- tgen 1 -->
  <rect x="150" y="200" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#glow)"/>
  <text x="210" y="225" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen 1</text>
  <text x="210" y="245" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.1</text>
  
  <!-- tgen 2 -->
  <rect x="290" y="200" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="350" y="225" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen 2</text>
  <text x="350" y="245" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.2</text>
  
  
  <!-- tgen 3 -->
  <rect x="150" y="290" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="210" y="315" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen 3</text>
  <text x="210" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.3</text>
  
  <!-- tgen n -->
  <rect x="290" y="290" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="350" y="315" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen n</text>
  <text x="350" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.n</text>
  
  <!-- Scalability indicator -->
  <text x="235" y="390" font-family="Arial, Helvetica, sans-serif" font-size="18" text-anchor="middle" fill="#2D5082">...</text>
  <text x="280" y="420" font-family="Arial, Helvetica, sans-serif" font-size="12" font-style="italic" text-anchor="middle" fill="#555">Scalable to n machines</text>
  <text x="280" y="440" font-family="Arial, Helvetica, sans-serif" font-size="12" font-style="italic" text-anchor="middle" fill="#555">for increased traffic volume</text>
  
  <!-- Moat Node (Miner) -->
  <rect x="490" y="250" width="140" height="160" rx="10" ry="10" fill="url(#moatGradient)" stroke="#4A7E3A" stroke-width="2" filter="url(#glow)"/>
  <text x="560" y="285" font-family="Arial, Helvetica, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">MOAT</text>
  <text x="560" y="310" font-family="Arial, Helvetica, sans-serif" font-size="14" text-anchor="middle" fill="white">(Miner)</text>
  <text x="560" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.1.3.141</text>
  <text x="560" y="360" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">AF_XDP Filtering</text>
  <text x="560" y="380" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">GRE: 192.168.110.2/30</text>
  <text x="560" y="395" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">GRE: 192.168.114.2/30</text>
  
  <!-- King Node -->
  <rect x="720" y="250" width="140" height="160" rx="10" ry="10" fill="url(#kingGradient)" stroke="#004C99" stroke-width="2" filter="url(#glow)"/>
  <text x="790" y="285" font-family="Arial, Helvetica, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">KING</text>
  <text x="790" y="310" font-family="Arial, Helvetica, sans-serif" font-size="14" text-anchor="middle" fill="#333">(Protected Server)</text>
  <text x="790" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="#333">10.1.3.23</text>
  <text x="790" y="360" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="#333">IPIP: 10.0.0.1/32</text>
  <text x="790" y="380" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="#333">GRE: 192.168.101.1/30</text>
  
  <!-- Connections and Traffic Flow -->
  <!-- Benign and Malicious Traffic from tgen 1 -->
  <path d="M270 235 Q 350 235, 490 280" fill="none" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowGreen)"/>
  <path d="M270 235 Q 380 255, 490 290" fill="none" stroke="#c0392b" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- Benign and Malicious Traffic from tgen 2 -->
  <path d="M410 235 Q 450 235, 490 270" fill="none" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowGreen)"/>
  <path d="M410 235 Q 450 250, 490 300" fill="none" stroke="#c0392b" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- Benign and Malicious Traffic from tgen 3 -->
  <path d="M270 325 Q 350 315, 490 310" fill="none" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowGreen)"/>
  <path d="M270 325 Q 380 335, 490 320" fill="none" stroke="#c0392b" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- Benign and Malicious Traffic from tgen n -->
  <path d="M410 325 Q 450 325, 490 340" fill="none" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowGreen)"/>
  <path d="M410 325 Q 450 340, 490 350" fill="none" stroke="#c0392b" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- GRE Tunnel from Moat to King -->
  <path d="M630 330 Q 675 330, 720 330" fill="none" stroke="#2851a3" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="640" y="315" font-family="Arial, Helvetica, sans-serif" font-size="12" fill="#2851a3">GRE Tunnel</text>
  
<!-- Legend (Top Right) -->
<rect x="680" y="120" width="180" height="75" rx="5" ry="5" fill="white" stroke="#888" stroke-width="1"/>

<!-- Benign Traffic -->
<line x1="700" y1="140" x2="740" y2="140" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3"/>
<text x="750" y="144" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="start" fill="#333">Benign Traffic</text>

<!-- Attack Traffic -->
<line x1="700" y1="160" x2="740" y2="160" stroke="#c0392b" stroke-width="2" stroke-dasharray="5,3"/>
<text x="750" y="164" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="start" fill="#333">Attack Traffic</text>

<!-- Filtered Traffic -->
<line x1="700" y1="180" x2="740" y2="180" stroke="#2851a3" stroke-width="2"/>
<text x="750" y="184" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="start" fill="#333">Filtered Traffic</text>


</svg>