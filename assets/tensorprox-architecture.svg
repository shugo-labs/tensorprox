<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600">
  <!-- Background with subtle gradient -->
  <defs>
    <linearGradient id="bg-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f9fa;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e9ecef;stop-opacity:1" />
    </linearGradient>
    
    <!-- Arrow markers -->
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#0072B2"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#D55E00"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#009E73"/>
    </marker>
    
    <!-- Shadow filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="3" />
      <feOffset dx="2" dy="2" result="offsetblur" />
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.2" />
      </feComponentTransfer>
      <feMerge>
        <feMergeNode />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    
    <!-- Node gradients -->
    <linearGradient id="tgenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6C8EBF;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4A6EA5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="moatGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#82B366;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#5D8A4A;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="kingGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#DAE8FC;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7EA6E0;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  
  <!-- Background -->
  <rect width="1000" height="600" fill="url(#bg-gradient)"/>
  
  <!-- Title and Subtitle -->
  <text x="500" y="40" font-family="Arial, Helvetica, sans-serif" font-size="28" text-anchor="middle" font-weight="bold" fill="#333">Tensorprox: Scalable DDoS Protection Architecture</text>
  <text x="500" y="70" font-family="Arial, Helvetica, sans-serif" font-size="16" text-anchor="middle" fill="#666">Distributed Traffic Generation and Filtering System</text>
  
  <!-- Physical Network Border -->
  <rect x="100" y="100" width="800" height="450" fill="none" stroke="#888" stroke-width="2" stroke-dasharray="5,5" rx="15" ry="15"/>
  <text x="160" y="125" font-family="Arial, Helvetica, sans-serif" font-size="14" fill="#555">Physical Network (10.0.0.0/24)</text>
  
  <!-- Traffic Generators Section -->
  <rect x="130" y="160" width="300" height="350" rx="10" ry="10" fill="rgba(224, 231, 255, 0.2)" stroke="#2D5082" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="280" y="180" font-family="Arial, Helvetica, sans-serif" font-size="18" text-anchor="middle" font-weight="bold" fill="#2D5082">Scalable Traffic Generators</text>
  
  <!-- tgen 1 -->
  <rect x="150" y="200" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#glow)"/>
  <text x="210" y="225" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen 1</text>
  <text x="210" y="245" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.1</text>
  
  <!-- tgen 2 -->
  <rect x="290" y="200" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="350" y="225" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen 2</text>
  <text x="350" y="245" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.2</text>
  
  
  <!-- tgen 3 -->
  <rect x="150" y="290" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="210" y="315" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen 3</text>
  <text x="210" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.3</text>
  
  <!-- tgen n -->
  <rect x="290" y="290" width="120" height="70" rx="8" ry="8" fill="url(#tgenGradient)" stroke="#2D5082" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="350" y="315" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">tgen n</text>
  <text x="350" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.200.77.n</text>
  
  <!-- Scalability indicator -->
  <text x="235" y="390" font-family="Arial, Helvetica, sans-serif" font-size="18" text-anchor="middle" fill="#2D5082">...</text>
  <text x="280" y="420" font-family="Arial, Helvetica, sans-serif" font-size="12" font-style="italic" text-anchor="middle" fill="#555">Scalable to n machines</text>
  <text x="280" y="440" font-family="Arial, Helvetica, sans-serif" font-size="12" font-style="italic" text-anchor="middle" fill="#555">for increased traffic volume</text>
  
  <!-- Moat Node (Miner) -->
  <rect x="490" y="250" width="140" height="160" rx="10" ry="10" fill="url(#moatGradient)" stroke="#4A7E3A" stroke-width="2" filter="url(#glow)"/>
  <text x="560" y="285" font-family="Arial, Helvetica, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">MOAT</text>
  <text x="560" y="310" font-family="Arial, Helvetica, sans-serif" font-size="14" text-anchor="middle" fill="white">(Miner)</text>
  <text x="560" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">10.1.3.141</text>
  <text x="560" y="360" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">AF_XDP Filtering</text>
  <text x="560" y="380" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">GRE: 192.168.110.2/30</text>
  <text x="560" y="395" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="white">GRE: 192.168.114.2/30</text>
  
  <!-- King Node -->
  <rect x="720" y="250" width="140" height="160" rx="10" ry="10" fill="url(#kingGradient)" stroke="#004C99" stroke-width="2" filter="url(#glow)"/>
  <text x="790" y="285" font-family="Arial, Helvetica, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">KING</text>
  <text x="790" y="310" font-family="Arial, Helvetica, sans-serif" font-size="14" text-anchor="middle" fill="#333">(Protected Server)</text>
  <text x="790" y="335" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="#333">10.1.3.23</text>
  <text x="790" y="360" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="#333">IPIP: 10.0.0.1/32</text>
  <text x="790" y="380" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="middle" fill="#333">GRE: 192.168.101.1/30</text>
  
  <!-- Connections and Traffic Flow -->
  <!-- Benign and Malicious Traffic from tgen 1 -->
  <path d="M270 235 Q 350 235, 490 280" fill="none" stroke="#0072B2" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowBlue)"/>
  <path d="M270 235 Q 380 255, 490 290" fill="none" stroke="#D55E00" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- Benign and Malicious Traffic from tgen 2 -->
  <path d="M410 235 Q 450 235, 490 270" fill="none" stroke="#0072B2" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowBlue)"/>
  <path d="M410 235 Q 450 250, 490 300" fill="none" stroke="#D55E00" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- Benign and Malicious Traffic from tgen 3 -->
  <path d="M270 325 Q 350 315, 490 310" fill="none" stroke="#0072B2" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowBlue)"/>
  <path d="M270 325 Q 380 335, 490 320" fill="none" stroke="#D55E00" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- Benign and Malicious Traffic from tgen n -->
  <path d="M410 325 Q 450 325, 490 340" fill="none" stroke="#0072B2" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowBlue)"/>
  <path d="M410 325 Q 450 340, 490 350" fill="none" stroke="#D55E00" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>
  
  <!-- GRE Tunnel from Moat to King -->
  <path d="M630 330 Q 675 330, 720 330" fill="none" stroke="#009E73" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="675" y="315" font-family="Arial, Helvetica, sans-serif" font-size="12" font-weight="bold" fill="#009E73">GRE Tunnel</text>
  <text x="675" y="350" font-family="Arial, Helvetica, sans-serif" font-size="12" fill="#009E73">Filtered Traffic</text>
  
  <!-- Legend -->
  <rect x="700" y="440" width="180" height="90" rx="5" ry="5" fill="white" stroke="#888" stroke-width="1"/>
  <text x="790" y="460" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Legend</text>

  <!-- Benign Traffic -->
  <line x1="750" y1="480" x2="730" y2="480" stroke="#0072B2" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="770" y="484" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="start" fill="#333">Benign Traffic</text>

  <!-- Attack Traffic -->
  <line x1="750" y1="500" x2="730" y2="500" stroke="#D55E00" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="770" y="504" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="start" fill="#333">Attack Traffic</text>

  <!-- Filtered Traffic -->
  <line x1="750" y1="520" x2="730" y2="520" stroke="#009E73" stroke-width="2"/>
  <text x="770" y="524" font-family="Arial, Helvetica, sans-serif" font-size="12" text-anchor="start" fill="#333">Filtered Traffic</text>

</svg>